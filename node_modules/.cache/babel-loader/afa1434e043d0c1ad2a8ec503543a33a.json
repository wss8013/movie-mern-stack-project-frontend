{"ast":null,"code":"import _slicedToArray from\"/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import update from\"immutability-helper\";import{useCallback,useState,useEffect}from\"react\";import{Card}from\"./FavoriteCard.js\";import style from\"./favorites.css\";import FavoritesDataService from\"../services/favorites\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var mStyle={width:500,margin:1};var FavoriteContainer=function FavoriteContainer(_ref){var user=_ref.user,favorites=_ref.favorites,addFavorite=_ref.addFavorite,deleteFavorite=_ref.deleteFavorite;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState([favorites]),_useState4=_slicedToArray(_useState3,2),myFavorites=_useState4[0],setMyFavorites=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),doSaveFaves=_useState6[0],setDoSaveFaves=_useState6[1];useEffect(function(){var getMovie=function getMovie(favorites){FavoritesDataService.getFavoriteListByMovieIds(favorites).then(function(response){//  let  movies =  addMoviesIndex(favorites, response.data.movies);\n//   console.error(movies);\nsetMovies(response.data.movies);}).catch(function(e){console.log(e);});};getMovie(favorites);setMyFavorites(favorites);setMovies(function(prevMovies){return prevMovies.sort(function(a,b){return favorites.indexOf(b)-favorites.indexOf(a);});});},[favorites]);useEffect(function(){if(user&&doSaveFaves){saveFavorites();setDoSaveFaves(false);}},[user,myFavorites,saveFavorites,doSaveFaves]);var saveFavorites=useCallback(function(){// let saveFavs = [];\n// for(let i = 0; i < myFavorites.length;i++) {\n//   saveFavs.push(myFavorites[i]);\n// }\nvar data={_id:user.googleId,favorites:myFavorites};FavoritesDataService.updateFavorites(data).catch(function(e){console.error(e);});},[myFavorites,user]);var moveCard=useCallback(function(dragIndex,hoverIndex){setMovies(function(prevMovies){return update(prevMovies,{$splice:[[dragIndex,1],[hoverIndex,0,prevMovies[dragIndex]]]});});setMyFavorites(function(prevMyFavorites){return update(prevMyFavorites,{$splice:[[dragIndex,1],[hoverIndex,0,prevMyFavorites[dragIndex]]]});});setDoSaveFaves(true);// console.error(myFavorites);\n// console.error(movies);\n},[]);var renderCard=useCallback(function(movie,index){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Card,{index:index,id:movie._id,movie:movie,moveCard:moveCard},movie._id)});},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"favoritesContainer container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"favoritesPanel\",children:\"Drag your favorites to rank them\"}),/*#__PURE__*/_jsx(\"div\",{children:movies.map(function(movie,i){return renderCard(movie,i);})})]});};export default FavoriteContainer;","map":{"version":3,"names":["update","useCallback","useState","useEffect","Card","style","FavoritesDataService","mStyle","width","margin","FavoriteContainer","user","favorites","addFavorite","deleteFavorite","movies","setMovies","myFavorites","setMyFavorites","doSaveFaves","setDoSaveFaves","getMovie","getFavoriteListByMovieIds","then","response","data","catch","e","console","log","prevMovies","sort","a","b","indexOf","saveFavorites","_id","googleId","updateFavorites","error","moveCard","dragIndex","hoverIndex","$splice","prevMyFavorites","renderCard","movie","index","map","i"],"sources":["/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/src/components/Container.js"],"sourcesContent":["import update from \"immutability-helper\";\nimport { useCallback, useState, useEffect } from \"react\";\nimport { Card } from \"./FavoriteCard.js\";\nimport style from \"./favorites.css\"\nimport FavoritesDataService from \"../services/favorites\";\nconst mStyle = {\n  width: 500,\n  margin: 1\n}\n\nconst FavoriteContainer = ({\n  user,\n  favorites,\n  addFavorite,\n  deleteFavorite\n}) => {\n  const [movies, setMovies] = useState([]);\n  const [myFavorites, setMyFavorites] = useState([favorites]);\n  const [doSaveFaves, setDoSaveFaves] = useState(false);\n\n  useEffect(() => {\n    const getMovie = favorites => {\n      FavoritesDataService.getFavoriteListByMovieIds(favorites)\n        .then(response => {\n          //  let  movies =  addMoviesIndex(favorites, response.data.movies);\n          //   console.error(movies);\n          setMovies(response.data.movies);\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    }\n    getMovie(favorites);\n    setMyFavorites(favorites);\n    setMovies((prevMovies) =>\n    prevMovies.sort(\n      (a, b) =>{\n       return favorites.indexOf(b)-favorites.indexOf(a);\n     })\n   )\n    \n  }, [favorites]);\n\n  useEffect(() => {\n    if (user && doSaveFaves) {\n      saveFavorites();\n      setDoSaveFaves(false);\n    }\n  }, [user, myFavorites, saveFavorites, doSaveFaves]);\n\n\n  const saveFavorites = useCallback(() => {\n    // let saveFavs = [];\n    // for(let i = 0; i < myFavorites.length;i++) {\n    //   saveFavs.push(myFavorites[i]);\n    // }\n    var data = {\n      _id: user.googleId,\n      favorites: myFavorites\n    }\n    FavoritesDataService.updateFavorites(data).catch(e => {\n      console.error(e);\n    });\n  }, [myFavorites, user]);\n\n  const moveCard = useCallback((dragIndex, hoverIndex) => {\n    setMovies((prevMovies) =>\n      update(prevMovies, {\n        $splice: [\n          [dragIndex, 1],\n          [hoverIndex, 0, prevMovies[dragIndex]]\n        ]\n      })\n    );\n\n    setMyFavorites((prevMyFavorites) =>\n      update(prevMyFavorites, {\n        $splice: [\n          [dragIndex, 1],\n          [hoverIndex, 0, prevMyFavorites[dragIndex]]\n        ]\n      })\n    );\n    setDoSaveFaves(true);\n    // console.error(myFavorites);\n    // console.error(movies);\n  }, []);\n  const renderCard = useCallback((movie, index) => {\n    return (\n      <div>\n        <Card\n          key={movie._id}\n          index={index}\n          id={movie._id}\n          movie={movie}\n          moveCard={moveCard}\n        />\n      </div>\n    );\n  }, []);\n\n  return (\n    <div className=\"favoritesContainer container\">\n      <div className=\"favoritesPanel\">\n        Drag your favorites to rank them\n      </div>\n      <div>\n        {movies.map((movie, i) => renderCard(movie, i))}\n      </div>\n    </div>\n  );\n\n};\nexport default FavoriteContainer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}