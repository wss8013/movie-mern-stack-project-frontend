{"ast":null,"code":"import _objectSpread from\"/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import MovieDataService from\"../services/movies\";import{useNavigate,Link,useParams}from'react-router-dom';import Col from'react-bootstrap/Col';import Row from'react-bootstrap/Row';import Container from'react-bootstrap/Container';import Card from'react-bootstrap/Card';import Image from\"react-bootstrap/Image\";import Button from\"react-bootstrap/Button\";import moment from\"moment\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Movie=function Movie(_ref){var user=_ref.user;var params=useParams();var _useState=useState({id:null,title:\"\",rated:\"\",poster:\"\",reviews:[]}),_useState2=_slicedToArray(_useState,2),movie=_useState2[0],setMovie=_useState2[1];useEffect(function(){var getMovie=function getMovie(id){MovieDataService.findById(id).then(function(response){console.log(response.data);setMovie(response.data);}).catch(function(e){console.log(e);});};getMovie(params.id);},[params.id]);var deleteReview=function deleteReview(review,index){var data={review_id:review._id,user_id:user.googleId};MovieDataService.deleteReview(data).then(function(response){setMovie(function(previousState){previousState.reviews.splice(index,1);return _objectSpread({},previousState);});}).catch(function(e){console.log(e);});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"poster\",children:/*#__PURE__*/_jsx(Image,{className:\"bigPicture\",src:movie.poster+\"/100px250\",onError:function onError(e){e.target.src='/images/NoPosterAvailable-crop.jpeg';// some replacement image\n},fluid:true})})}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{as:\"h5\",children:movie.title}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Text,{children:movie.plot}),user&&/*#__PURE__*/_jsx(Link,{to:\"/movies/\"+params.id+\"/review\",children:\"Add Review\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Reviews\"}),/*#__PURE__*/_jsx(\"br\",{}),movie.reviews.map(function(review,index){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 reviewText\",children:[/*#__PURE__*/_jsxs(\"h5\",{children:[review.name+\" reviewed on \",\" \",moment(review.date).format(\"Do MMMM YYYY\")]}),/*#__PURE__*/_jsx(\"p\",{className:\"review\",children:review.review}),user&&user.googleId===review.user_id&&/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:{pathname:\"/movies/\"+params.id+\"/review\"},state:{currentReview:review},children:\"Edit\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Button,{variant:\"link\",onClick:function onClick(){deleteReview(review,index);},children:\"delete\"})})]})]})});})]})]})})});};export default Movie;","map":{"version":3,"names":["React","useState","useEffect","MovieDataService","useNavigate","Link","useParams","Col","Row","Container","Card","Image","Button","moment","axios","Movie","user","params","id","title","rated","poster","reviews","movie","setMovie","getMovie","findById","then","response","console","log","data","catch","e","deleteReview","review","index","review_id","_id","user_id","googleId","previousState","splice","target","src","plot","map","name","date","format","pathname","currentReview"],"sources":["/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/src/components/Movie.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport MovieDataService from \"../services/movies\";\nimport { useNavigate, Link, useParams } from 'react-router-dom';\nimport Col from 'react-bootstrap/Col';\nimport Row from 'react-bootstrap/Row';\nimport Container from 'react-bootstrap/Container';\nimport Card from 'react-bootstrap/Card';\nimport Image from \"react-bootstrap/Image\";\nimport Button from \"react-bootstrap/Button\";\nimport moment from \"moment\";\nimport axios from \"axios\";\n\nconst Movie = ({ user }) => {\n    let params = useParams();\n\n    const [movie, setMovie] = useState({\n        id: null,\n        title: \"\",\n        rated: \"\",\n        poster: \"\",\n        reviews: []\n    });\n\n    useEffect(() => {\n        const getMovie = id => {\n            MovieDataService.findById(id)\n                .then(response => {\n                    console.log(response.data);\n                    setMovie(response.data);\n                }).catch(e => {\n                    console.log(e);\n                })\n\n        }\n        getMovie(params.id);\n    }, [params.id]);\n    \n    const deleteReview = (review, index) => {\n        var data = {\n            review_id: review._id,\n            user_id: user.googleId,\n        }\n        MovieDataService.deleteReview(data)\n            .then(response => {\n                setMovie((previousState)=> {\n                    previousState.reviews.splice(index,1);\n                    return ({\n                        ...previousState\n                    })\n                })\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    };\n\n    return (\n        <div>\n            <Container>\n                <Row>\n                    <Col>\n                        <div className=\"poster\">\n                            <Image\n                                className=\"bigPicture\"\n                                src={movie.poster + \"/100px250\"}\n                                onError={(e) => {\n                                    e.target.src = '/images/NoPosterAvailable-crop.jpeg' // some replacement image\n                                }}\n                                fluid />\n                        </div>\n                    </Col>\n                    <Col>\n                        <Card>\n                            <Card.Header as=\"h5\">\n                                {movie.title}\n                            </Card.Header>\n                            <Card.Body>\n                                <Card.Text>\n                                    {movie.plot}\n                                </Card.Text>\n                                {user && <Link to={\"/movies/\" + params.id + \"/review\"}>\n                                    Add Review\n                                </Link>}\n                            </Card.Body>\n                        </Card>\n                        <h2>\n                            Reviews\n                        </h2>\n                        <br></br>\n                        {movie.reviews.map((review, index) => {\n                            return (\n                                <div className=\"d-flex\">\n                                    <div className=\"flex-shrink-0 reviewText\">\n                                        <h5>{review.name + \" reviewed on \"} {moment(review.date).format(\"Do MMMM YYYY\")}</h5>\n                                        <p className=\"review\">{review.review}</p>\n                                        {user && user.googleId === review.user_id &&\n                                            <Row>\n                                                <Col>\n                                                    <Link to={{\n                                                        pathname: \"/movies/\" + params.id + \"/review\"\n                                                    }}\n                                                        state={{\n                                                            currentReview: review\n                                                        }}>\n                                                        Edit\n                                                    </Link>\n                                                </Col>\n                                                <Col>\n                                                    <Button variant=\"link\" onClick={() => {\n                                                        deleteReview(review, index);\n                                                    }}>\n                                                        delete\n                                                    </Button>\n                                                </Col>\n                                            </Row>\n                                        }\n                                    </div>\n                                </div>\n                            )\n                        })}\n                    </Col>\n                </Row>\n            </Container>\n        </div>\n    );\n}\n\nexport default Movie;"],"mappings":"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"},"metadata":{},"sourceType":"module"}