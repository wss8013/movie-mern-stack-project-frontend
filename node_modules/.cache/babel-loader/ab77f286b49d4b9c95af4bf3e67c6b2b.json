{"ast":null,"code":"import _toConsumableArray from\"/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{GoogleOAuthProvider}from'@react-oauth/google';import{Routes,Route,Link}from'react-router-dom';import\"bootstrap/dist/css/bootstrap.min.css\";import Container from'react-bootstrap/Container';import Nav from'react-bootstrap/Nav';import Navbar from'react-bootstrap/Navbar';import{useState,useEffect,useCallback}from'react';import Login from'./components/Login';import Logout from'./components/Logout';import MoviesList from\"./components/MoviesList\";import Movie from\"./components/Movie\";import AddReview from\"./components/AddReview\";import FavoritesDataService from\"./services/favorites\";import FContainer from'./components/Container';import{DndProvider}from'react-dnd';import{HTML5Backend}from'react-dnd-html5-backend';import'./App.css';import{NavbarBrand}from'react-bootstrap';import Example from'./components/example';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var clientId=process.env.REACT_APP_GOOGLE_CLIENT_ID;function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),favorites=_useState4[0],setFavorites=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),doSaveFaves=_useState6[0],setDoSaveFaves=_useState6[1];var retrieveFavorites=useCallback(function(){FavoritesDataService.getFavoritesByUserId(user.googleId).then(function(response){setFavorites(response.data.favorites);}).catch(function(e){console.error(e);});},[user]);var saveFavorites=useCallback(function(){var data={_id:user.googleId,favorites:favorites};FavoritesDataService.updateFavorites(data).catch(function(e){console.error(e);});},[favorites,user]);useEffect(function(){if(user&&doSaveFaves){saveFavorites();setDoSaveFaves(false);}},[user,favorites,saveFavorites,doSaveFaves]);useEffect(function(){if(user){retrieveFavorites();}},[user,retrieveFavorites]);var addFavorite=function addFavorite(movieId){setDoSaveFaves(true);setFavorites([].concat(_toConsumableArray(favorites),[movieId]));};var deleteFavorite=function deleteFavorite(movieId){setFavorites(favorites.filter(function(f){return f!==movieId;}));};useEffect(function(){var loginData=JSON.parse(localStorage.getItem(\"login\"));if(loginData){var loginExp=loginData.exp;var now=Date.now()/1000;if(now<loginExp){// Not expired\nsetUser(loginData);}else{// Expired\nlocalStorage.setItem(\"login\",null);}}},[]);return/*#__PURE__*/_jsx(GoogleOAuthProvider,{clientId:clientId,children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Navbar,{bg:\"primary\",expand:\"lg\",sticky:\"top\",variant:\"dark\",children:/*#__PURE__*/_jsxs(Container,{className:\"container-fluid\",children:[/*#__PURE__*/_jsxs(Navbar.Brand,{className:\"brand\",href:\"/\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/movies-logo.png\",alt:\"movie logo\",className:\"moviesLogo\"}),\"MOVIE TIME\"]}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"basic-navbar-nav\"}),/*#__PURE__*/_jsx(Navbar.Collapse,{id:\"responsive-navbar-nav\",children:/*#__PURE__*/_jsxs(Nav,{className:\"ml-auto\",children:[/*#__PURE__*/_jsx(Nav.Link,{as:Link,to:\"/movies\",children:\"Movies\"}),user?/*#__PURE__*/_jsx(Nav.Link,{as:Link,to:\"/favorites\",children:\"Favorites\"}):/*#__PURE__*/_jsx(Nav.Link,{})]})}),user?/*#__PURE__*/_jsx(Logout,{setUser:setUser}):/*#__PURE__*/_jsx(Login,{setUser:setUser})]})}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(MoviesList,{user:user,addFavorite:addFavorite,deleteFavorite:deleteFavorite,favorites:favorites})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/movies\",element:/*#__PURE__*/_jsx(MoviesList,{user:user,addFavorite:addFavorite,deleteFavorite:deleteFavorite,favorites:favorites})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/favorites\",element:/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsx(Example,{})})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/movies/:id/\",element:/*#__PURE__*/_jsx(Movie,{user:user})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/movies/:id/review\",element:/*#__PURE__*/_jsx(AddReview,{user:user})})]})]})});}export default App;","map":{"version":3,"names":["GoogleOAuthProvider","Routes","Route","Link","Container","Nav","Navbar","useState","useEffect","useCallback","Login","Logout","MoviesList","Movie","AddReview","FavoritesDataService","FContainer","DndProvider","HTML5Backend","NavbarBrand","Example","clientId","process","env","REACT_APP_GOOGLE_CLIENT_ID","App","user","setUser","favorites","setFavorites","doSaveFaves","setDoSaveFaves","retrieveFavorites","getFavoritesByUserId","googleId","then","response","data","catch","e","console","error","saveFavorites","_id","updateFavorites","addFavorite","movieId","deleteFavorite","filter","f","loginData","JSON","parse","localStorage","getItem","loginExp","exp","now","Date","setItem"],"sources":["/Users/shashawang/Desktop/NEU2022Summer/Web5610/classRepo-MERN-project/shasha-wang-frontend/src/App.js"],"sourcesContent":["import { GoogleOAuthProvider } from '@react-oauth/google';\n\nimport { Routes, Route, Link } from 'react-router-dom';\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Container from 'react-bootstrap/Container';\nimport Nav from 'react-bootstrap/Nav';\nimport Navbar from 'react-bootstrap/Navbar';\nimport { useState, useEffect, useCallback } from 'react';\nimport Login from './components/Login';\nimport Logout from './components/Logout';\n\nimport MoviesList from \"./components/MoviesList\"\nimport Movie from \"./components/Movie\"\nimport AddReview from \"./components/AddReview\"\nimport FavoritesDataService from \"./services/favorites\";\nimport FContainer from './components/Container';\nimport { DndProvider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\n\n\nimport './App.css';\nimport { NavbarBrand } from 'react-bootstrap';\nimport Example from './components/example';\n\nconst clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [favorites, setFavorites] = useState([]);\n  const [doSaveFaves, setDoSaveFaves] = useState(false);\n  const retrieveFavorites = useCallback(() => {\n    FavoritesDataService.getFavoritesByUserId(user.googleId)\n      .then(response => {\n        setFavorites(response.data.favorites);\n      }).catch(e => {\n        console.error(e);\n      });\n  }, [user]);\n\n  const saveFavorites = useCallback(() => {\n    var data = {\n      _id: user.googleId,\n      favorites: favorites\n    }\n    FavoritesDataService.updateFavorites(data).catch(e => {\n      console.error(e);\n    });\n  }, [favorites, user]);\n\n  useEffect(() => {\n    if (user && doSaveFaves) {\n      saveFavorites();\n      setDoSaveFaves(false);\n    }\n  }, [user, favorites, saveFavorites, doSaveFaves]);\n\n  useEffect(() => {\n    if (user) {\n      retrieveFavorites();\n    }\n  }, [user, retrieveFavorites]);\n\n  const addFavorite = (movieId) => {\n    setDoSaveFaves(true);\n    setFavorites([...favorites, movieId]);\n  }\n\n  const deleteFavorite = (movieId) => {\n    setFavorites(favorites.filter(f => f !== movieId));\n  }\n\n  useEffect(() => {\n    let loginData = JSON.parse(localStorage.getItem(\"login\"));\n    if (loginData) {\n      let loginExp = loginData.exp;\n      let now = Date.now() / 1000;\n      if (now < loginExp) {\n        // Not expired\n        setUser(loginData);\n      } else {\n        // Expired\n        localStorage.setItem(\"login\", null);\n      }\n    }\n  }, []);\n\n  return (\n    <GoogleOAuthProvider clientId={clientId}>\n      <div className=\"App\">\n        <Navbar bg=\"primary\" expand=\"lg\" sticky=\"top\" variant=\"dark\">\n          <Container className=\"container-fluid\">\n            <Navbar.Brand className=\"brand\" href=\"/\">\n              <img src=\"/images/movies-logo.png\" alt=\"movie logo\" className=\"moviesLogo\" />\n              MOVIE TIME\n            </Navbar.Brand>\n            <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n            <Navbar.Collapse id=\"responsive-navbar-nav\">\n              <Nav className=\"ml-auto\">\n                <Nav.Link as={Link} to={\"/movies\"}>\n                  Movies\n                </Nav.Link>\n                {user ? (\n                  <Nav.Link as={Link} to={\"/favorites\"}>\n                    Favorites\n                  </Nav.Link>\n                ) : (\n                  <Nav.Link >\n                  </Nav.Link>\n                )}\n              </Nav>\n            </Navbar.Collapse>\n            {user ? (\n              <Logout setUser={setUser} />\n            ) : (\n              <Login setUser={setUser} />\n\n            )}\n          </Container>\n        </Navbar>\n        <Routes>\n          <Route exact path={\"/\"} element={\n            <MoviesList\n              user={user}\n              addFavorite={addFavorite}\n              deleteFavorite={deleteFavorite}\n              favorites={favorites}\n            />}\n          />\n          <Route exact path={\"/movies\"} element={\n            <MoviesList\n              user={user}\n              addFavorite={addFavorite}\n              deleteFavorite={deleteFavorite}\n              favorites={favorites}\n            />}\n          />\n          <Route exact path={\"/favorites\"} element={\n           <DndProvider backend={HTML5Backend}>\n           <Example />\n         </DndProvider>}\n          />\n          <Route exact path={\"/movies/:id/\"} element={\n            <Movie user={user} />}\n          />\n          <Route exact path={\"/movies/:id/review\"} element={\n            <AddReview user={user} />}\n          />\n        </Routes>\n      </div>\n    </GoogleOAuthProvider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}